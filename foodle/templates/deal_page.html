{% extends 'base.html' %}
{% load staticfiles %}

{% block head %}
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="/static/css/img.css">
{% endblock %}

{% block content %}
<!-- greg's deal_page details (start) -->
<div id="map"></div>

<div class="container">
    <br />
    <br />
    <br />
  {% for deal in deals %}
  <div class="card-columns">

    <br />
    <br />
    <br />
    <div class="card">

        {% if deal.picture %}
        <img class="card-img-top" src="{{ deal.picture.url }}" alt="Card image cap">
        {% endif %}

        <div class="card-body">
          <h5 class="card-title">Deal</h5>
          <p class="card-text">{{deal.info}}</p>
          <ul class="nav">

            <a class="nav-link btn" href="deal_page"><i class="far fa-heart"></i> {{deal.likes_count}}</a>
            <a class="nav-link" href="https://github.com/glasgowm148/foodle_dev"><i class="far fa-bookmark"></i></a>
            <a class="nav-link" href="https://github.com/glasgowm148/foodle_dev"><i class="far fa-flag"></i></a>
            <a class="nav-link" href="https://github.com/glasgowm148/foodle_dev"><i class="fas fa-share-alt"></i></a>
          </ul>
        </div>
      </div>
  </div>
    {% endfor %}
    <br />
    <br />
    <br />

    </div>

  </div> <!-- row end -->
</div>
<!--container end-->


<script>

 if (navigator.geolocation) { 
   navigator.geolocation.getCurrentPosition(function (position) {      
     var lat = position.coords.latitude;                   
     var lng = position.coords.longitude;                
     var curLoc = new google.maps.LatLng(lat, lng); 
     var directionsService = new google.maps.DirectionsService();
     var directionsDisplay = new google.maps.DirectionsRenderer();
     var mapOptions = { 
       zoom: 15,  
       center: curLoc, 
       mapTypeControl: true, 
     }; 
     map = new google.maps.Map(document.getElementById("map"), mapOptions);
     directionsDisplay.setMap(map);
	 var request = { 
       origin: curLoc,
       destination: 'soba, byres road',   <!-- THIS IS A STATIC LOCATION. IDEA IS TO PARSE IN ADDRESS FROM DATABASE OF DEAL VENDOR
       travelMode: google.maps.DirectionsTravelMode.DRIVING
     }; 
     directionsService.route(request, function (response, status) { 
       if (status == google.maps.DirectionsStatus.OK) { 
         directionsDisplay.setDirections(response);
       } 
     }); 
   });
 } 
    </script>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDye3jFXoyb4arMeb6ea6w1c_gTyS8RE5Y&callback=initMap">
</script>
<!-- greg deal_page details (end)	-->
{% endblock %}
